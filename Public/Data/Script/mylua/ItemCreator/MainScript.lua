--LuaFnHaveImpactOfSpecificDataIndex(sceneId, selfId, XXXX)--Kiem tra Impact tren nguoi nhan vat--
--LuaFnSendSpecificImpactToUnit( sceneId, selfId, selfId, selfId, XXXX, 0)--Them Impact len nhan vat--
--LuaFnCancelSpecificImpact(sceneId, selfId, XXXX)--Huy bo Impact tren nguoi nhan vat--
x045050_g_Equip1List = {
	{10000000,0,"Ðao Búa",20103008},
		{10200011,1,20103001,25,20103061,10,20103097,12,20308001,1},
		{10200012,1,20103002,30,20103062,15,20103097,15,20308002,1},
		{10200013,1,20103003,35,20103063,20,20103097,21,20308003,1},
		{10200014,1,20103004,40,20103064,25,20103098,24,20308004,1},
		{10200015,1,20103005,45,20103065,30,20103098,27,20308005,1},
		{10200016,1,20103006,50,20103066,35,20103098,33,20308006,1},
		{10200017,1,20103007,55,20103067,40,20103099,48,20308007,1},
		{10200018,1,20103008,60,20103068,45,20103099,52,20308008,1},
		{10200019,1,20103009,65,20103069,50,20103099,60,20308009,1},
		{10200020,1,20103010,70,20103070,55,20103099,64,20308010,1},

	{10001000,0,"Thß½ng T¥n",20103008},
		{10201011,1,20103001,25,20103061,10,20103097,12,20308011,1},
		{10201012,1,20103002,30,20103062,15,20103097,15,20308012,1},
		{10201013,1,20103003,35,20103063,20,20103097,21,20308013,1},
		{10201014,1,20103004,40,20103064,25,20103098,24,20308014,1},
		{10201015,1,20103005,45,20103065,30,20103098,27,20308015,1},
		{10201016,1,20103006,50,20103066,35,20103098,33,20308016,1},
		{10201017,1,20103007,55,20103067,40,20103099,48,20308017,1},
		{10201018,1,20103008,60,20103068,45,20103099,52,20308018,1},
		{10201019,1,20103009,65,20103069,50,20103099,60,20308019,1},
		{10201020,1,20103010,70,20103070,55,20103099,64,20308020,1},

	{10002000,0,"Ð½n Ðoän",20103008},
		{10202011,1,20103001,25,20103061,10,20103097,12,20308021,1},
		{10202012,1,20103002,30,20103062,15,20103097,15,20308022,1},
		{10202013,1,20103003,35,20103063,20,20103097,21,20308023,1},
		{10202014,1,20103004,40,20103064,25,20103098,24,20308024,1},
		{10202015,1,20103005,45,20103065,30,20103098,27,20308025,1},
		{10202016,1,20103006,50,20103066,35,20103098,33,20308026,1},
		{10202017,1,20103007,55,20103067,40,20103099,48,20308027,1},
		{10202018,1,20103008,60,20103068,45,20103099,52,20308028,1},
		{10202019,1,20103009,65,20103069,50,20103099,60,20308029,1},
		{10202020,1,20103010,70,20103070,55,20103099,64,20308030,1},

	{10003000,0,"Song Ðoän",20103008},
		{10203011,1,20103001,25,20103061,10,20103097,12,20308031,1},
		{10203012,1,20103002,30,20103062,15,20103097,15,20308032,1},
		{10203013,1,20103003,35,20103063,20,20103097,21,20308033,1},
		{10203014,1,20103004,40,20103064,25,20103098,24,20308034,1},
		{10203015,1,20103005,45,20103065,30,20103098,27,20308035,1},
		{10203016,1,20103006,50,20103066,35,20103098,33,20308036,1},
		{10203017,1,20103007,55,20103067,40,20103099,48,20308037,1},
		{10203018,1,20103008,60,20103068,45,20103099,52,20308038,1},
		{10203019,1,20103009,65,20103069,50,20103099,60,20308039,1},
		{10203020,1,20103010,70,20103070,55,20103099,64,20308040,1},

	{10004000,0,"Phiªn",20103008},
		{10204011,1,20103001,25,20103061,10,20103097,12,20308041,1},
		{10204012,1,20103002,30,20103062,15,20103097,15,20308042,1},
		{10204013,1,20103003,35,20103063,20,20103097,21,20308043,1},
		{10204014,1,20103004,40,20103064,25,20103098,24,20308044,1},
		{10204015,1,20103005,45,20103065,30,20103098,27,20308045,1},
		{10204016,1,20103006,50,20103066,35,20103098,33,20308046,1},
		{10204017,1,20103007,55,20103067,40,20103099,48,20308047,1},
		{10204018,1,20103008,60,20103068,45,20103099,52,20308048,1},
		{10204019,1,20103009,65,20103069,50,20103099,60,20308049,1},
		{10204020,1,20103010,70,20103070,55,20103099,64,20308050,1},

	{10005000,0,"Khuyên",10205011},
		{10205011,1,20103001,25,20103061,10,20103097,12,20308051,1},
		{10205012,1,20103002,30,20103062,15,20103097,15,20308052,1},
		{10205013,1,20103003,35,20103063,20,20103097,21,20308053,1},
		{10205014,1,20103004,40,20103064,25,20103098,24,20308054,1},
		{10205015,1,20103005,45,20103065,30,20103098,27,20308055,1},
		{10205016,1,20103006,50,20103066,35,20103098,33,20308056,1},
		{10205017,1,20103007,55,20103067,40,20103099,48,20308057,1},
		{10205018,1,20103008,60,20103068,45,20103099,52,20308058,1},
		{10205019,1,20103009,65,20103069,50,20103099,60,20308059,1},
		{10205020,1,20103010,70,20103070,55,20103099,64,20308060,1},
}

x045050_g_Equip2List = {
	{10010000,0,"MÕo TØ",10210016},
		{10210002,2,20105001,28,20103073,12,20103100,24,20308061,1},
		{10210004,2,20105002,32,20103074,16,20103100,27,20308062,1},
		{10210006,2,20105003,36,20103075,20,20103100,33,20308063,1},
		{10210008,2,20105004,40,20103076,24,20103101,36,20308064,1},
		{10210010,2,20105005,44,20103077,28,20103101,39,20308065,1},
		{10210012,2,20105006,48,20103078,32,20103101,45,20308066,1},
		{10210014,2,20105007,52,20103079,36,20103102,64,20308067,1},
		{10210016,2,20105008,56,20103080,40,20103102,68,20308068,1},
		{10210018,2,20105009,60,20103081,44,20103102,76,20308069,1},
		{10210020,2,20105010,64,20103082,48,20103102,80,20308070,1},
		{10210022,2,20105001,28,20103073,12,20103100,24,20308061,1},
		{10210024,2,20105002,32,20103074,16,20103100,27,20308062,1},
		{10210026,2,20105003,36,20103075,20,20103100,33,20308063,1},
		{10210028,2,20105004,40,20103076,24,20103101,36,20308064,1},
		{10210030,2,20105005,44,20103077,28,20103101,39,20308065,1},
		{10210032,2,20105006,48,20103078,32,20103101,45,20308066,1},
		{10210034,2,20105007,52,20103079,36,20103102,64,20308067,1},
		{10210036,2,20105008,56,20103080,40,20103102,68,20308068,1},
		{10210038,2,20105009,60,20103081,44,20103102,76,20308069,1},
		{10210040,2,20105010,64,20103082,48,20103102,80,20308070,1},
		{10210042,2,20105001,28,20103073,12,20103100,24,20308061,1},
		{10210044,2,20105002,32,20103074,16,20103100,27,20308062,1},
		{10210046,2,20105003,36,20103075,20,20103100,33,20308063,1},
		{10210048,2,20105004,40,20103076,24,20103101,36,20308064,1},
		{10210050,2,20105005,44,20103077,28,20103101,39,20308065,1},
		{10210052,2,20105006,48,20103078,32,20103101,45,20308066,1},
		{10210054,2,20105007,52,20103079,36,20103102,64,20308067,1},
		{10210056,2,20105008,56,20103080,40,20103102,68,20308068,1},
		{10210058,2,20105009,60,20103081,44,20103102,76,20308069,1},
		{10210060,2,20105010,64,20103082,48,20103102,80,20308070,1},

	{10020000,0,"Y Phøc",10213016},
		{10213002,2,20105001,28,20103073,12,20103100,24,20308071,1},
		{10213004,2,20105002,32,20103074,16,20103100,27,20308072,1},
		{10213006,2,20105003,36,20103075,20,20103100,33,20308073,1},
		{10213008,2,20105004,40,20103076,24,20103101,36,20308074,1},
		{10213010,2,20105005,44,20103077,28,20103101,39,20308075,1},
		{10213012,2,20105006,48,20103078,32,20103101,45,20308076,1},
		{10213014,2,20105007,52,20103079,36,20103102,64,20308077,1},
		{10213016,2,20105008,56,20103080,40,20103102,68,20308078,1},
		{10213018,2,20105009,60,20103081,44,20103102,76,20308079,1},
		{10213020,2,20105010,64,20103082,48,20103102,80,20308080,1},
		{10213022,2,20105001,28,20103073,12,20103100,24,20308071,1},
		{10213024,2,20105002,32,20103074,16,20103100,27,20308072,1},
		{10213026,2,20105003,36,20103075,20,20103100,33,20308073,1},
		{10213028,2,20105004,40,20103076,24,20103101,36,20308074,1},
		{10213030,2,20105005,44,20103077,28,20103101,39,20308075,1},
		{10213032,2,20105006,48,20103078,32,20103101,45,20308076,1},
		{10213034,2,20105007,52,20103079,36,20103102,64,20308077,1},
		{10213036,2,20105008,56,20103080,40,20103102,68,20308078,1},
		{10213038,2,20105009,60,20103081,44,20103102,76,20308079,1},
		{10213040,2,20105010,64,20103082,48,20103102,80,20308080,1},
		{10213042,2,20105001,28,20103073,12,20103100,24,20308071,1},
		{10213044,2,20105002,32,20103074,16,20103100,27,20308072,1},
		{10213046,2,20105003,36,20103075,20,20103100,33,20308073,1},
		{10213048,2,20105004,40,20103076,24,20103101,36,20308074,1},
		{10213050,2,20105005,44,20103077,28,20103101,39,20308075,1},
		{10213052,2,20105006,48,20103078,32,20103101,45,20308076,1},
		{10213054,2,20105007,52,20103079,36,20103102,64,20308077,1},
		{10213056,2,20105008,56,20103080,40,20103102,68,20308078,1},
		{10213058,2,20105009,60,20103081,44,20103102,76,20308079,1},
		{10213060,2,20105010,64,20103082,48,20103102,80,20308080,1},

	{10030000,0,"Hµ Thü",10212016},
		{10212002,2,20105001,28,20103073,12,20103100,24,20308081,1},
		{10212004,2,20105002,32,20103074,16,20103100,27,20308082,1},
		{10212006,2,20105003,36,20103075,20,20103100,33,20308083,1},
		{10212008,2,20105004,40,20103076,24,20103101,36,20308084,1},
		{10212010,2,20105005,44,20103077,28,20103101,39,20308085,1},
		{10212012,2,20105006,48,20103078,32,20103101,45,20308086,1},
		{10212014,2,20105007,52,20103079,36,20103102,64,20308087,1},
		{10212016,2,20105008,56,20103080,40,20103102,68,20308088,1},
		{10212018,2,20105009,60,20103081,44,20103102,76,20308089,1},
		{10212020,2,20105010,64,20103082,48,20103102,80,20308090,1},
		{10212022,2,20105001,28,20103073,12,20103100,24,20308081,1},
		{10212024,2,20105002,32,20103074,16,20103100,27,20308082,1},
		{10212026,2,20105003,36,20103075,20,20103100,33,20308083,1},
		{10212028,2,20105004,40,20103076,24,20103101,36,20308084,1},
		{10212030,2,20105005,44,20103077,28,20103101,39,20308085,1},
		{10212032,2,20105006,48,20103078,32,20103101,45,20308086,1},
		{10212034,2,20105007,52,20103079,36,20103102,64,20308087,1},
		{10212036,2,20105008,56,20103080,40,20103102,68,20308088,1},
		{10212038,2,20105009,60,20103081,44,20103102,76,20308089,1},
		{10212040,2,20105010,64,20103082,48,20103102,80,20308090,1},
		{10212042,2,20105001,28,20103073,12,20103100,24,20308081,1},
		{10212044,2,20105002,32,20103074,16,20103100,27,20308082,1},
		{10212046,2,20105003,36,20103075,20,20103100,33,20308083,1},
		{10212048,2,20105004,40,20103076,24,20103101,36,20308084,1},
		{10212050,2,20105005,44,20103077,28,20103101,39,20308085,1},
		{10212052,2,20105006,48,20103078,32,20103101,45,20308086,1},
		{10212054,2,20105007,52,20103079,36,20103102,64,20308087,1},
		{10212056,2,20105008,56,20103080,40,20103102,68,20308088,1},
		{10212058,2,20105009,60,20103081,44,20103102,76,20308089,1},
		{10212060,2,20105010,64,20103082,48,20103102,80,20308090,1},
	
	{10040000,0,"Hài TØ",10211016},
		{10211002,2,20105001,28,20103073,12,20103100,24,20308091,1},
		{10211004,2,20105002,32,20103074,16,20103100,27,20308092,1},
		{10211006,2,20105003,36,20103075,20,20103100,33,20308093,1},
		{10211008,2,20105004,40,20103076,24,20103101,36,20308094,1},
		{10211010,2,20105005,44,20103077,28,20103101,39,20308095,1},
		{10211012,2,20105006,48,20103078,32,20103101,45,20308096,1},
		{10211014,2,20105007,52,20103079,36,20103102,64,20308097,1},
		{10211016,2,20105008,56,20103080,40,20103102,68,20308098,1},
		{10211018,2,20105009,60,20103081,44,20103102,76,20308099,1},
		{10211020,2,20105010,64,20103082,48,20103102,80,20308100,1},
		{10211022,2,20105001,28,20103073,12,20103100,24,20308091,1},
		{10211024,2,20105002,32,20103074,16,20103100,27,20308092,1},
		{10211026,2,20105003,36,20103075,20,20103100,33,20308093,1},
		{10211028,2,20105004,40,20103076,24,20103101,36,20308094,1},
		{10211030,2,20105005,44,20103077,28,20103101,39,20308095,1},
		{10211032,2,20105006,48,20103078,32,20103101,45,20308096,1},
		{10211034,2,20105007,52,20103079,36,20103102,64,20308097,1},
		{10211036,2,20105008,56,20103080,40,20103102,68,20308098,1},
		{10211038,2,20105009,60,20103081,44,20103102,76,20308099,1},
		{10211040,2,20105010,64,20103082,48,20103102,80,20308100,1},
		{10211042,2,20105001,28,20103073,12,20103100,24,20308091,1},
		{10211044,2,20105002,32,20103074,16,20103100,27,20308092,1},
		{10211046,2,20105003,36,20103075,20,20103100,33,20308093,1},
		{10211048,2,20105004,40,20103076,24,20103101,36,20308094,1},
		{10211050,2,20105005,44,20103077,28,20103101,39,20308095,1},
		{10211052,2,20105006,48,20103078,32,20103101,45,20308096,1},
		{10211054,2,20105007,52,20103079,36,20103102,64,20308097,1},
		{10211056,2,20105008,56,20103080,40,20103102,68,20308098,1},
		{10211058,2,20105009,60,20103081,44,20103102,76,20308099,1},
		{10211060,2,20105010,64,20103082,48,20103102,80,20308100,1},

	{10050000,0,"Yêu Ðái",10221018},
		{10221011,2,20105001,28,20103073,12,20103100,24,20308151,1},
		{10221012,2,20105002,32,20103074,16,20103100,27,20308152,1},
		{10221013,2,20105003,36,20103075,20,20103100,33,20308153,1},
		{10221014,2,20105004,40,20103076,24,20103101,36,20308154,1},
		{10221015,2,20105005,44,20103077,28,20103101,39,20308155,1},
		{10221016,2,20105006,48,20103078,32,20103101,45,20308156,1},
		{10221017,2,20105007,52,20103079,36,20103102,64,20308157,1},
		{10221018,2,20105008,56,20103080,40,20103102,68,20308158,1},
		{10221019,2,20105009,60,20103081,44,20103102,76,20308159,1},
		{10221020,2,20105010,64,20103082,48,20103102,80,20308160,1},

	{10140000,0,"Hµ Uy¬n",10214016},
		{10214002,2,20105001,28,20103073,12,20103100,24,20308131,1},
		{10214004,2,20105002,32,20103074,16,20103100,27,20308132,1},
		{10214006,2,20105003,36,20103075,20,20103100,33,20308133,1},
		{10214008,2,20105004,40,20103076,24,20103101,36,20308134,1},
		{10214010,2,20105005,44,20103077,28,20103101,39,20308135,1},
		{10214012,2,20105006,48,20103078,32,20103101,45,20308136,1},
		{10214014,2,20105007,52,20103079,36,20103102,64,20308137,1},
		{10214016,2,20105008,56,20103080,40,20103102,68,20308138,1},
		{10214018,2,20105009,60,20103081,44,20103102,76,20308139,1},
		{10214020,2,20105010,64,20103082,48,20103102,80,20308140,1},

	{10150000,0,"Hµ Kiên",10215016},
		{10215002,2,20105001,28,20103073,12,20103100,24,20308141,1},
		{10215004,2,20105002,32,20103074,16,20103100,27,20308142,1},
		{10215006,2,20105003,36,20103075,20,20103100,33,20308143,1},
		{10215008,2,20105004,40,20103076,24,20103101,36,20308144,1},
		{10215010,2,20105005,44,20103077,28,20103101,39,20308145,1},
		{10215012,2,20105006,48,20103078,32,20103101,45,20308146,1},
		{10215014,2,20105007,52,20103079,36,20103102,64,20308147,1},
		{10215016,2,20105008,56,20103080,40,20103102,68,20308148,1},
		{10215018,2,20105009,60,20103081,44,20103102,76,20308149,1},
		{10215020,2,20105010,64,20103082,48,20103102,80,20308150,1},
}

x045050_g_Equip3List = {
	{10070000,0,"HÕng Liên",10220018},
		{10220011,3,20103001,7,20103085,12,20308101,1,-1,-1},
		{10220012,3,20103002,14,20103086,24,20308102,1,-1,-1},
		{10220013,3,20103003,21,20103087,42,20308103,1,-1,-1},
		{10220014,3,20103004,28,20103088,54,20308104,1,-1,-1},
		{10220015,3,20103005,35,20103089,66,20308105,1,-1,-1},
		{10220016,3,20103006,42,20103090,84,20308106,1,-1,-1},
		{10220017,3,20103007,49,20103091,96,20308107,1,-1,-1},
		{10220018,3,20103008,56,20103092,108,20308108,1,-1,-1},
		{10220019,3,20103009,63,20103093,126,20308109,1,-1,-1},
		{10220020,3,20103010,69,20103094,138,20308110,1,-1,-1},

	{10060000,0,"Gi¾i Chï",10222018},
		{10222011,3,20103001,7,20103085,12,20308111,1,-1,-1},
		{10222012,3,20103002,14,20103086,24,20308112,1,-1,-1},
		{10222013,3,20103003,21,20103087,42,20308113,1,-1,-1},
		{10222014,3,20103004,28,20103088,54,20308114,1,-1,-1},
		{10222015,3,20103005,35,20103089,66,20308115,1,-1,-1},
		{10222016,3,20103006,42,20103090,84,20308116,1,-1,-1},
		{10222017,3,20103007,49,20103091,96,20308117,1,-1,-1},
		{10222018,3,20103008,56,20103092,108,20308118,1,-1,-1},
		{10222031,3,20103008,56,20103092,108,20308118,1,-1,-1},
		{10222032,3,20103008,56,20103092,108,20308118,1,-1,-1},
		{10222019,3,20103009,63,20103093,126,20308119,1,-1,-1},
		{10222033,3,20103009,63,20103093,126,20308119,1,-1,-1},
		{10222034,3,20103009,63,20103093,126,20308119,1,-1,-1},
		{10222020,3,20103010,69,20103094,138,20308120,1,-1,-1},
		{10222035,3,20103010,69,20103094,138,20308120,1,-1,-1},
		{10222036,3,20103010,69,20103094,138,20308120,1,-1,-1},
	
	{10120000,0,"Hµ Phù",10223018},
		{10223011,3,20103001,7,20103085,12,20308121,1,-1,-1},
		{10223012,3,20103002,14,20103086,24,20308122,1,-1,-1},
		{10223013,3,20103003,21,20103087,42,20308123,1,-1,-1},
		{10223014,3,20103004,28,20103088,54,20308124,1,-1,-1},
		{10223015,3,20103005,35,20103089,66,20308125,1,-1,-1},
		{10223016,3,20103006,42,20103090,84,20308126,1,-1,-1},
		{10223017,3,20103007,49,20103091,96,20308127,1,-1,-1},
		{10223018,3,20103008,56,20103092,108,20308128,1,-1,-1},
		{10223031,3,20103008,56,20103092,108,20308128,1,-1,-1},
		{10223032,3,20103008,56,20103092,108,20308128,1,-1,-1},
		{10223019,3,20103009,63,20103093,126,20308129,1,-1,-1},
		{10223033,3,20103009,63,20103093,126,20308129,1,-1,-1},
		{10223034,3,20103009,63,20103093,126,20308129,1,-1,-1},
		{10223020,3,20103010,69,20103094,138,20308130,1,-1,-1},
		{10223035,3,20103010,69,20103094,138,20308130,1,-1,-1},
		{10223036,3,20103010,69,20103094,138,20308130,1,-1,-1},
}

x045050_g_Material = {"Tinh Thiªt","Väi Bông","Bí Ngân"}
x045050_g_EquipRandStar = {3,3,3,3,3,3,4,4,4,4,4,5,5,5,5,6,6,6,7,7,8}
x045050_g_MaterialStar = {}
x045050_g_MaterialStar[1] = {2,2,2,2,2,3,3,3,3,4,4,4,5,5,6}
x045050_g_MaterialStar[2] = {3,3,3,3,3,4,4,4,4,5,5,5,6,6,7}
x045050_g_MaterialStar[3] = {4,4,4,4,4,5,5,5,5,6,6,6,7,7,8}
x045050_g_MaterialStar[4] = {8}

x045050_g_DieuVanDT = {} --DieuVanPhu, DanThanh, HoangChi
x045050_g_DieuVanDT[30110001] = {30120001,10,0}
x045050_g_DieuVanDT[30110002] = {30120011,10,0}
x045050_g_DieuVanDT[30110003] = {30120021,20,20}
x045050_g_DieuVanDT[30110004] = {30120031,10,0}
x045050_g_DieuVanDT[30110005] = {30120041,20,20}
x045050_g_DieuVanDT[30110006] = {30120051,20,20}
x045050_g_DieuVanDT[30110007] = {30120061,20,20}
x045050_g_DieuVanDT[30110008] = {30120071,20,20}
x045050_g_DieuVanDT[30110009] = {30120081,20,20}
x045050_g_DieuVanDT[30110010] = {30120091,20,20}
x045050_g_DieuVanDT[30110011] = {30120101,20,20}
x045050_g_DieuVanDT[30110012] = {30120111,20,20}
x045050_g_DieuVanDT[30110013] = {30120121,20,20}
x045050_g_DieuVanDT[30110014] = {30120131,60,60}
x045050_g_DieuVanDT[30110015] = {30120141,60,60}
x045050_g_DieuVanDT[30110016] = {30120151,60,60}
x045050_g_DieuVanDT[30110017] = {30120161,60,60}
x045050_g_DieuVanDT[30110018] = {30120171,10,0}
x045050_g_DieuVanDT[30110019] = {30120181,10,0}
x045050_g_DieuVanDT[30110020] = {30120191,10,0}
x045050_g_DieuVanDT[30110021] = {30120201,10,0}

--Num: max 250
--NoItem = "88888888"
x045050_g_NewbieGift = {}
x045050_g_NewbieGift[10] = {
	Active = 1, DCSpace = 1, NLSpace = 2,
	Item1 = 30008014, Num1 = "001",
	Item2 = 50401001, Num2 = "001",
	Item3 = 50401002, Num3 = "001",
	Item4 = 88888888, Num4 = "020",
	Item5 = 88888888, Num5 = "020",
}

x045050_g_NewbieGift[20] = {
	Active = 1, DCSpace = 1, NLSpace = 3,
	Item1 = 30008014, Num1 = "001",
	Item2 = 50401001, Num2 = "001",
	Item3 = 50401002, Num3 = "001",
	Item4 = 50413004, Num4 = "001",
	Item5 = 88888888, Num5 = "020",
}
x045050_g_NewbieGift[30] = {
	Active = 1, DCSpace = 2, NLSpace = 3,
	Item1 = 30008014, Num1 = "001",
	Item2 = 50401001, Num2 = "001",
	Item3 = 50401002, Num3 = "001",
	Item4 = 50413004, Num4 = "001",
	Item5 = 30900115, Num5 = "001",
}
x045050_g_NewbieGift[40] = {
	Active = 1, DCSpace = 3, NLSpace = 5,
	Item1 = 30008014, Num1 = "002",
	Item2 = 50401001, Num2 = "002",
	Item3 = 50401002, Num3 = "002",
	Item4 = 50413004, Num4 = "001",
	Item5 = 30900115, Num5 = "001",
}
x045050_g_NewbieGift[50] = {
	Active = 1, DCSpace = 4, NLSpace = 6,
	Item1 = 30008014, Num1 = "002",
	Item2 = 50401001, Num2 = "002",
	Item3 = 50401002, Num3 = "002",
	Item4 = 50413004, Num4 = "002",
	Item5 = 30900115, Num5 = "002",
}
x045050_g_NewbieGift[60] = {
	Active = 1, DCSpace = 2, NLSpace = 3,
	Item1 = 30008014, Num1 = "002",
	Item2 = 50501001, Num2 = "001",
	Item3 = 50501002, Num3 = "001",
	Item4 = 50513004, Num4 = "001",
	Item5 = 88888888, Num5 = "000",
}
x045050_g_NewbieGift[70] = {
	Active = 1, DCSpace = 4, NLSpace = 3,
	Item1 = 30008014, Num1 = "003",
	Item2 = 50501001, Num2 = "001",
	Item3 = 50501002, Num3 = "001",
	Item4 = 50513004, Num4 = "001",
	Item5 = 30900116, Num5 = "001",
}
x045050_g_NewbieGift[80] = {
	Active = 1, DCSpace = 4, NLSpace = 5,
	Item1 = 30008014, Num1 = "003",
	Item2 = 50501001, Num2 = "002",
	Item3 = 50501002, Num3 = "002",
	Item4 = 50513004, Num4 = "001",
	Item5 = 30900116, Num5 = "001",
}
x045050_g_NewbieGift[90] = {
	Active = 1, DCSpace = 5, NLSpace = 6,
	Item1 = 30008014, Num1 = "003",
	Item2 = 50501001, Num2 = "002",
	Item3 = 50501002, Num3 = "002",
	Item4 = 50513004, Num4 = "002",
	Item5 = 30900116, Num5 = "002",
}

function x045050_OnCreateItem(sceneId, selfId, type, param1, param2, param3, param4)	
	-- LuaFnAddGlobalCountNews(sceneId,"TLBB WINNER")
	if type == 16 then
		if param1 >= 0 and param1 <= 29 then
			--Write Author
			local Author, szAuthor = LuaFnGetItemCreator(sceneId,selfId,param1)
			local nDay = 0;
			if szAuthor then
				nDay = tonumber(szAuthor)
				if nDay >= 1 and nDay < 1000 then
					local NowDate = nDay + GetDayTime()			
					local FormatDate = GetFormatDate(NowDate)
					LuaFnSetItemCreator(sceneId,selfId,param1,FormatDate)
				end
			else
				LuaFnSetItemCreator(sceneId,selfId,param1,"00000000")
			end

			BeginUICommand( sceneId )
				UICommand_AddInt( sceneId, param1 ) --0
				EndUICommand( sceneId )
			DispatchUICommand( sceneId, selfId, 122001 )
		end
	end
	
	if type == 9 then --NewbieGift
		if param1 == 1 then --Open
			BeginUICommand( sceneId )
				UICommand_AddString( sceneId, "" ) --0
				for i = 1, 9 do
					local Index = i*10
					if x045050_g_NewbieGift[Index].Active == 1 then
						local ListID = x045050_g_NewbieGift[Index].Item1..x045050_g_NewbieGift[Index].Item2..x045050_g_NewbieGift[Index].Item3..x045050_g_NewbieGift[Index].Item4..x045050_g_NewbieGift[Index].Item5;
						local ListNum = x045050_g_NewbieGift[Index].Num1..x045050_g_NewbieGift[Index].Num2..x045050_g_NewbieGift[Index].Num3..x045050_g_NewbieGift[Index].Num4..x045050_g_NewbieGift[Index].Num5;
						
						UICommand_AddString( sceneId, ListID..ListNum )
					else
						UICommand_AddString( sceneId, 0 )
					end
				end
				EndUICommand( sceneId )
			DispatchUICommand( sceneId, selfId, 1026002 )
		end
		
		if param1 == 2 then --GiftRC
			if param2 < 1 or param2 > 9 then
				x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM!")
				return
			end
			
			local CharLV = GetLevel(sceneId,selfId)
			local NeedLV = param2*10
			if CharLV < NeedLV then
				x045050_NotifyTip(sceneId, selfId, "C¤p ðµ vçn chßa ðÕt "..NeedLV)
				return
			end
			
			local CharData = GetMissionData(sceneId,selfId,QUA_TANG_THANG_CAP)
			local CharDataLen = strlen(CharData)
			
			if CharDataLen < 9 then
				for i = 1, 9 - CharDataLen do
					CharData = "0"..CharData;
				end
			end

			if strsub(CharData,param2,param2) == "1" then
				x045050_NotifyTip(sceneId, selfId, "Các hÕ ðã nh§n quà t£ng này r°i!")
				return
			end
			
			if x045050_g_NewbieGift[NeedLV].DCSpace > LuaFnGetPropertyBagSpace(sceneId,selfId) then
				x045050_NotifyTip(sceneId, selfId, "Yêu c¥u "..x045050_g_NewbieGift[NeedLV].DCSpace.." ô tr¯ng túi ÐÕo Cø")
				return
			end
			
			if x045050_g_NewbieGift[NeedLV].NLSpace > LuaFnGetMaterialBagSpace(sceneId,selfId) then
				x045050_NotifyTip(sceneId, selfId, "Yêu c¥u "..x045050_g_NewbieGift[NeedLV].NLSpace.." ô tr¯ng túi Nguyên Li®u")
				return
			end
			
			local ItemID1 = x045050_g_NewbieGift[NeedLV].Item1
			local ItemID2 = x045050_g_NewbieGift[NeedLV].Item2
			local ItemID3 = x045050_g_NewbieGift[NeedLV].Item3
			local ItemID4 = x045050_g_NewbieGift[NeedLV].Item4
			local ItemID5 = x045050_g_NewbieGift[NeedLV].Item5
			
			if ItemID1 ~= 88888888 then
				local ItemNum1 = x045050_g_NewbieGift[NeedLV].Num1
				for i = 1, ItemNum1 do
					local Item1 = TryRecieveItem(sceneId,selfId,ItemID1,1)
					LuaFnItemBind(sceneId,selfId,Item1)
				end
			end
			
			if ItemID2 ~= 88888888 then
				local ItemNum2 = x045050_g_NewbieGift[NeedLV].Num2
				for i = 1, ItemNum2 do
					local Item2 = TryRecieveItem(sceneId,selfId,ItemID2,1)
					LuaFnItemBind(sceneId,selfId,Item2)
				end
			end
			
			if ItemID3 ~= 88888888 then
				local ItemNum3 = x045050_g_NewbieGift[NeedLV].Num3
				for i = 1, ItemNum3 do
					local Item3 = TryRecieveItem(sceneId,selfId,ItemID3,1)
					LuaFnItemBind(sceneId,selfId,Item3)
				end
			end
			
			if ItemID4 ~= 88888888 then
				local ItemNum4 = x045050_g_NewbieGift[NeedLV].Num4
				for i = 1, ItemNum4 do
					local Item4 = TryRecieveItem(sceneId,selfId,ItemID4,1)
					LuaFnItemBind(sceneId,selfId,Item4)
				end
			end
			
			if ItemID5 ~= 88888888 then
				local ItemNum5 = x045050_g_NewbieGift[NeedLV].Num5
				for i = 1, ItemNum5 do
					local Item5 = TryRecieveItem(sceneId,selfId,ItemID5,1)
					LuaFnItemBind(sceneId,selfId,Item5)
				end
			end
			
			local RunData = "";
			local EndData = "";
			
			if param2 == 1 then
				RunData = ""
				EndData = strsub(CharData,param2+1,9)
			elseif param2 >= 2 and param2 <= 8 then
				RunData = strsub(CharData,1,param2-1)
				EndData = strsub(CharData,param2+1,9)
			elseif param2 == 9 then
				RunData = strsub(CharData,1,param2-1)
				EndData = ""
			end
			
			SetMissionData(sceneId,selfId,QUA_TANG_THANG_CAP,tonumber(RunData.."1"..EndData))
			
			x045050_OnCreateItem(sceneId, selfId, 9, 1, 0)
			
			x045050_NotifyTip(sceneId, selfId, "Nh§n thß·ng thành công!")
			LuaFnSendSpecificImpactToUnit(sceneId,selfId,selfId,selfId,148,0)
		end
	end
	
	if type == 211 then --Hop Thanh Dieu Van
		local DoTuongID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,param1)
		if DoTuongID < 30110001 or DoTuongID > 30110021 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u Ðiêu Vån Ð° Tß¶ng.")
			return
		end
		
		local DanThanh_ID = {20310173,20310172,20310169}
		local DanThanhCD = LuaFnGetAvailableItemCount(sceneId,selfId,DanThanh_ID[1]);
		local DanThanhKNB = LuaFnGetAvailableItemCount(sceneId,selfId,DanThanh_ID[2]);
		local DanThanh = LuaFnGetAvailableItemCount(sceneId,selfId,DanThanh_ID[3]);
		
		if DanThanhCD + DanThanhKNB + DanThanh < x045050_g_DieuVanDT[DoTuongID][2] then
			x045050_NotifyTip(sceneId,selfId,"Ngß½i không có ðü "..x045050_g_DieuVanDT[DoTuongID][2].." cái "..GetItemName(sceneId,DanThanh_ID[1])..".")
			return
		end
		
		local HoangChi_ID = 20502009
		local HoangChi = LuaFnGetAvailableItemCount(sceneId,selfId,HoangChi_ID)
		if HoangChi < x045050_g_DieuVanDT[DoTuongID][3] then
			x045050_NotifyTip(sceneId,selfId,"Ngß½i không có ðü "..x045050_g_DieuVanDT[DoTuongID][3].." cái "..GetItemName(sceneId,HoangChi_ID)..".")
			return
		end
		
		if LuaFnCostMoneyWithPriority(sceneId, selfId, 50000) == -1 then
			x045050_NotifyTip(sceneId, selfId, "Không ðü ngân lßþng!")
			return
		end
		
		local BindSTT = 0
		if LuaFnGetItemBindStatus(sceneId, selfId, param1) == 1 then
			BindSTT = 1;
		end

		EraseItem(sceneId,selfId,param1)
		if x045050_g_DieuVanDT[DoTuongID][3] > 1 then
			LuaFnDelAvailableItem(sceneId,selfId,HoangChi_ID,x045050_g_DieuVanDT[DoTuongID][3])
		end
		x045050_MaterialNeed(sceneId,selfId,x045050_g_DieuVanDT[DoTuongID][2],20310173,20310172,20310169)
		
		local DanThanhCD1 = LuaFnGetAvailableItemCount(sceneId,selfId,DanThanh_ID[1]);
		if DanThanhCD > DanThanhCD1 then
			BindSTT = 1;
		end
		
		local DwPhuID = x045050_g_DieuVanDT[DoTuongID][1];
		local DwPhu = TryRecieveItem(sceneId,selfId,DwPhuID,1)
		
		if BindSTT == 1 then
			LuaFnItemBind(sceneId,selfId,DwPhu)
		end
		
		x045050_NotifyTip( sceneId, selfId, "Ðã hþp thành "..GetItemName(sceneId,DwPhuID))
		LuaFnSendSpecificImpactToUnit(sceneId,selfId,selfId,selfId,148,0)
	end
	
	if type == 0 then --Che Do NL
		if mod(param1,1000) == 0 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		local EquipType = 0;
		local EquipInfo = {}
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip1List) do
				if x045050_g_Equip1List[i][1] == param1 then
					EquipType = 1;
					EquipInfo = x045050_g_Equip1List[i];
					break
				end
			end
		end
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip2List) do
				if x045050_g_Equip2List[i][1] == param1 then
					EquipType = 2;
					EquipInfo = x045050_g_Equip2List[i];
					break
				end
			end
		end
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip3List) do
				if x045050_g_Equip3List[i][1] == param1 then
					EquipType = 3;
					EquipInfo = x045050_g_Equip3List[i];
					break
				end
			end
		end
		
		if EquipType == 0 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		if EquipInfo[3] ~= -1 then
			if LuaFnGetAvailableItemCount(sceneId,selfId,EquipInfo[3]) < EquipInfo[4] then
				x045050_NotifyTip(sceneId, selfId, "Không có ðü "..GetItemName(sceneId,EquipInfo[3]))
				return
			end
		end
		
		if EquipInfo[5] ~= -1 then
			if LuaFnGetAvailableItemCount(sceneId,selfId,EquipInfo[5]) < EquipInfo[6] then
				x045050_NotifyTip(sceneId, selfId, "Không có ðü "..GetItemName(sceneId,EquipInfo[5]))
				return
			end
		end
		
		if EquipInfo[7] ~= -1 then
			if LuaFnGetAvailableItemCount(sceneId,selfId,EquipInfo[7]) < EquipInfo[8] then
				x045050_NotifyTip(sceneId, selfId, "Không có ðü "..GetItemName(sceneId,EquipInfo[7]))
				return
			end
		end
		
		if EquipInfo[9] ~= -1 then
			if LuaFnGetAvailableItemCount(sceneId,selfId,EquipInfo[9]) < EquipInfo[10] then
				x045050_NotifyTip(sceneId, selfId, "Không có ðü "..GetItemName(sceneId,EquipInfo[9]))
				return
			end
		end
		
		if LuaFnGetPropertyBagSpace(sceneId, selfId) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u 1 ô tr¯ng trong túi ðÕo cø!")
			return
		end
		
		if EquipInfo[3] ~= -1 then
			LuaFnDelAvailableItem(sceneId,selfId,EquipInfo[3],EquipInfo[4])
		end
		
		if EquipInfo[5] ~= -1 then
			LuaFnDelAvailableItem(sceneId,selfId,EquipInfo[5],EquipInfo[6])
		end
		
		if EquipInfo[7] ~= -1 then
			LuaFnDelAvailableItem(sceneId,selfId,EquipInfo[7],EquipInfo[8])
		end
		
		if EquipInfo[9] ~= -1 then
			LuaFnDelAvailableItem(sceneId,selfId,EquipInfo[9],EquipInfo[10])
		end
		
		local EquipID = param1;
		local Star = x045050_g_EquipRandStar[random(1,getn(x045050_g_EquipRandStar))]
		
		EquipID = EquipID + Star*100;
		local EquipNew = TryRecieveItem(sceneId,selfId,EquipID,0)
		LuaFnSetItemCreator(sceneId,selfId,EquipNew,GetName(sceneId,selfId))
		
		x045050_NotifyTip(sceneId, selfId, "Chª tÕo trang b¸ thành công!")
		if Star >= 8 then
			-- local ItemInfo = GetBagItemTransfer( sceneId, selfId, EquipNew )
			-- local PlayerName = GetName(sceneId, selfId)
			-- local StrText = format("#{_INFOUSR%s} #Rtrong lúc chª tÕo trang b¸, vô tình ðã ðúc ra cñc ph¦m #{_INFOMSG%s}#P.", PlayerName, ItemInfo)
			-- BroadMsgByChatPipe(sceneId,selfId, StrText, 4)
		end
	end
	
	if type == 1 then --Che Do KNS
		if mod(param1,1000) == 0 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		local EquipType = 0;
		local EquipInfo = {}
		
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip1List) do
				if x045050_g_Equip1List[i][1] == param1 then
					EquipType = 1;
					EquipInfo = x045050_g_Equip1List[i];
					break
				end
			end
		end
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip2List) do
				if x045050_g_Equip2List[i][1] == param1 then
					EquipType = 2;
					EquipInfo = x045050_g_Equip2List[i];
					break
				end
			end
		end
		if EquipType == 0 then
			for i = 1, getn(x045050_g_Equip3List) do
				if x045050_g_Equip3List[i][1] == param1 then
					EquipType = 3;
					EquipInfo = x045050_g_Equip3List[i];
					break
				end
			end
		end
		
		if EquipType == 0 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		if param2 < 30 or param2 > 59 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u nguyên li®u "..x045050_g_Material[EquipType])
			return
		end
		
		local MaterialID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,param2)
		if MaterialID < 20400300 or MaterialID > 20502008 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u nguyên li®u "..x045050_g_Material[EquipType])
			return
		end
		
		if mod(MaterialID,100) == 0 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u nguyên li®u "..x045050_g_Material[EquipType])
			return
		end
		
		local MaterialTYPE = tonumber(strsub(MaterialID,5,5)) + 1
		if MaterialTYPE ~= EquipType then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u nguyên li®u "..x045050_g_Material[EquipType])
			return
		end
		
		local BindSTT = 0;
		if MaterialID >= 20400300 and MaterialID <= 20402308 then
			BindSTT = 1;
		end
		
		local DaTaoDoID = 0
		if EquipType == 3 then
			DaTaoDoID = EquipInfo[7];
		else
			DaTaoDoID = EquipInfo[9];
		end
		
		if LuaFnGetAvailableItemCount(sceneId, selfId, DaTaoDoID) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u "..GetItemName(sceneId,DaTaoDoID))
			return
		end
		
		if LuaFnGetPropertyBagSpace(sceneId, selfId) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u 1 ô tr¯ng trong túi ðÕo cø!")
			return
		end
		
		local EquipID = param1;
		local MaterialLevel = mod(MaterialID,10)
		local Star = x045050_g_MaterialStar[MaterialLevel][random(1,getn(x045050_g_MaterialStar[MaterialLevel]))]
		
		EquipID = EquipID + Star*100;
		
		LuaFnDelAvailableItem(sceneId,selfId,DaTaoDoID,1)
		LuaFnDelAvailableItem(sceneId,selfId,MaterialID,1)
		
		local EquipNew = TryRecieveItem(sceneId,selfId,EquipID,0)
		LuaFnSetItemCreator(sceneId,selfId,EquipNew,GetName(sceneId,selfId))
		if BindSTT == 1 then
			LuaFnItemBind(sceneId,selfId,EquipNew)
		end
		
		x045050_NotifyTip(sceneId, selfId, "Chª tÕo trang b¸ thành công!")
		if Star >= 8 then
			-- local ItemInfo = GetBagItemTransfer( sceneId, selfId, EquipNew )
			-- local PlayerName = GetName(sceneId, selfId)
			-- local StrText = format("#{_INFOUSR%s} #Rtrong lúc chª tÕo trang b¸, vô tình ðã ðúc ra cñc ph¦m #{_INFOMSG%s}#P.", PlayerName, ItemInfo)
			-- BroadMsgByChatPipe(sceneId,selfId, StrText, 4)
		end
	end
	
	if type == 2 then
		local MaterialID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,param1)
		if MaterialID < 20400300 or MaterialID > 20502008 then
			x045050_NotifyTip(sceneId, selfId, "Chï có th¬ hþp thành Nguyên Li®u")
			return
		end
		
		local MaterialLevel = mod(MaterialID,10)
		if MaterialLevel >= 3 then
			x045050_NotifyTip(sceneId, selfId, "Nguyên Li®u không th¬ hþp thành c¤p cao h½n!")
			return
		end
		
		if LuaFnGetAvailableItemCount(sceneId,selfId,MaterialID) < 5 then
			x045050_NotifyTip(sceneId, selfId, "Ngß½i không có ðü 5 mänh "..GetItemName(sceneId,MaterialID))
			return
		end
		
		if LuaFnGetMaterialBagSpace(sceneId, selfId) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u 1 ô tr¯ng trong túi Nguyên Li®u!")
			return
		end
		
		local MoneyNeed = (MaterialLevel+1)*10000;
		if LuaFnCostMoneyWithPriority(sceneId, selfId, MoneyNeed) == -1 then
			x045050_NotifyTip(sceneId, selfId, "Không ðü ngân lßþng!")
			return
		end
		
		LuaFnDelAvailableItem(sceneId,selfId,MaterialID,5)
		TryRecieveItem(sceneId,selfId,MaterialID+1,1)
		
		x045050_NotifyTip(sceneId, selfId, "Ðã hþp thành "..GetItemName(sceneId,MaterialID+1))
	end
	
	if type == 5 then
		if param1 <= 0 then
			x045050_NotifyTip(sceneId, selfId, "S¯ nguyên bäo nh§p vào không hþp l®!")
			return
		end
		
		local MyYuanbao = YuanbaoMD(sceneId,selfId,0,0)
		if MyYuanbao < param1 then
			x045050_NotifyTip(sceneId, selfId, "Không có ðü s¯ nguyên bäo!")
			return
		end
		
		if LuaFnGetPropertyBagSpace(sceneId,selfId) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Yêu c¥u 1 ô tr¯ng trong túi ÐÕo Cø!")
			return
		end
		
		YuanbaoMD(sceneId,selfId,1,-param1)
		local CardKNB = TryRecieveItem(sceneId,selfId,30130005,1)
		LuaFnSetItemCreator(sceneId,selfId,CardKNB,param1)
		
		x045050_NotifyTip(sceneId, selfId, "Ð±i phiªu nguyên bäo thành công!")
	end
	
	if type == 500 then
		-- LuaFnAddGlobalCountNews(sceneId,"TLBB WINNER")
		local Index1 = tonumber(strsub(param2,2,3))
		local Index2 = tonumber(strsub(param2,4,5))
		local Index3 = tonumber(strsub(param3,2,3))
		local Index4 = tonumber(strsub(param3,4,5))
		local Index5 = tonumber(strsub(param4,2,3))
		local Index6 = tonumber(strsub(param4,4,5))
		
		if Index1 <= 29 or Index1 >= 60 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		if Index2 <= 29 or Index2 >= 60 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		if Index3 <= 29 or Index3 >= 60 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		if Index6 >= 30 then
			x045050_NotifyTip(sceneId, selfId, "Sai sót nµi bµ, vui lòng liên h® GM")
			return
		end
		
		local Item1ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index1)
		if Item1ID < 50101001 then
			x045050_NotifyTip(sceneId, selfId, "N½i ðây chï có th¬ h½p thành bäo thÕch!")
			return
		end
		
		local Item2ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index2)
		if Item2ID ~= Item1ID then
			x045050_NotifyTip(sceneId, selfId, "Bäo thÕch ðßa vào phäi gi¯ng nhau!")
			return
		end
		
		local Item3ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index3)
		if Item3ID ~= Item1ID then
			x045050_NotifyTip(sceneId, selfId, "Bäo thÕch ðßa vào phäi gi¯ng nhau!")
			return
		end
		
		local Lucky = 50;
		
		local Item4ID = 0
		if Index4 >= 29 and Index4 <= 59 then
			Lucky = Lucky + 25;
			Item4ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index4)
			if Item4ID ~= Item1ID then
				x045050_NotifyTip(sceneId, selfId, "Bäo thÕch ðßa vào phäi gi¯ng nhau!")
				return
			end
		end
		local Item5ID = 0
		if Index5 >= 29 and Index5 <= 59 then
			Lucky = Lucky + 25;
			Item5ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index5)
			if Item5ID ~= Item1ID then
				x045050_NotifyTip(sceneId, selfId, "Bäo thÕch ðßa vào phäi gi¯ng nhau!")
				return
			end
		end
		
		local GemLevel = tonumber(strsub(Item1ID,3,3))
		if GemLevel >= 6 then
			x045050_NotifyTip(sceneId, selfId, "Gi¾i hÕn hþp thành Bäo ThÕch!")
			return
		end
		
		local Item6ID = LuaFnGetItemTableIndexByIndex(sceneId,selfId,Index6)
		
		if GemLevel <= 3 then
			if Item6ID ~= 30900015 and Item6ID ~= 30900115 then
				x045050_NotifyTip(sceneId, selfId, "Yêu c¥u S½ C¤p Bäo ThÕch Hþp Thành Phù")
				return
			end
		elseif GemLevel >= 4 then
			if Item6ID ~= 30900016 and Item6ID ~= 30900116 then
				x045050_NotifyTip(sceneId, selfId, "Yêu c¥u Cao C¤p Bäo ThÕch Hþp Thành Phù")
				return
			end
		end
		
		if LuaFnGetAvailableItemCount(sceneId, selfId, Item6ID) < 1 then
			x045050_NotifyTip(sceneId, selfId, "Không ðü nguyên li®u ho£c nguyên li®u ðã b¸ khóa" )
			return
		end
		
		if LuaFnCostMoneyWithPriority(sceneId,selfId,GemLevel*10000) == -1 then
			x045050_NotifyTip(sceneId, selfId, "Không có ðü ngân lßþng!")
			return
		end
		
		local BindSTT = 0;
		local Bind1 = LuaFnGetItemBindStatus(sceneId, selfId, Index1)
		local Bind2 = LuaFnGetItemBindStatus(sceneId, selfId, Index2)
		local Bind3 = LuaFnGetItemBindStatus(sceneId, selfId, Index3)
		local Bind4 = LuaFnGetItemBindStatus(sceneId, selfId, Index4)
		local Bind5 = LuaFnGetItemBindStatus(sceneId, selfId, Index5)
		
		if Bind1 == 1 or Bind2 == 1 or Bind3 == 1 or Bind4 == 1 or Bind5 == 1 then
			BindSTT = 1;
		end
		
		if Item6ID == 30900115 or Item6ID == 30900116 then
			BindSTT = 1;
		end
		
		local FalseItemInfo = GetBagItemTransfer( sceneId, selfId, Index1 )
		
		EraseItem(sceneId,selfId,Index1)
		EraseItem(sceneId,selfId,Index2)
		EraseItem(sceneId,selfId,Index3)
		if Index4 >= 29 and Index4 <= 59 then
			EraseItem(sceneId,selfId,Index4)
		end
		if Index5 >= 29 and Index5 <= 59 then
			EraseItem(sceneId,selfId,Index5)
		end
		LuaFnDelAvailableItem(sceneId,selfId,Item6ID,1)
		
		local Random = random(1,100)
		if Random >= Lucky then
			--False
			local FalseNum = floor(Lucky/25) + 1
			local PlayerName = GetName(sceneId, selfId)
			local StrText = format("#{_INFOUSR%s} trong lúc c¯ g¡ng hþp thành bäo thÕch ðã làm vÞ vøn "..FalseNum.." viên #{_INFOMSG%s}#P.", PlayerName, FalseItemInfo)
			BroadMsgByChatPipe(sceneId,selfId, StrText, 4)
		else
			--Success
			local NewGem = TryRecieveItem(sceneId,selfId,Item1ID+100000,1)
			if BindSTT == 1 then
				LuaFnItemBind(sceneId,selfId,NewGem)
			end
			local ItemInfo = GetBagItemTransfer( sceneId, selfId, NewGem )
			local PlayerName = GetName(sceneId, selfId)
			local StrText = format("#{_INFOUSR%s}#H träi qua 1 s¯ n± lñc, cu¯i cùng ðã hþp thành ðßþc #{_INFOMSG%s}#H.", PlayerName, ItemInfo)
			BroadMsgByChatPipe( sceneId, selfId, StrText, 4 )
		end
		
	end
end

function x045050_NotifyTip(sceneId, selfId, Msg)
	BeginEvent( sceneId )
		AddText( sceneId, Msg )
	EndEvent( sceneId )
	DispatchMissionTips( sceneId, selfId )
end

function x045050_MaterialNeed(sceneId,selfId,nNum,Item1ID,Item2ID,Item3ID)
	local Item1 = LuaFnGetAvailableItemCount(sceneId,selfId,Item1ID)
	local Item2 = LuaFnGetAvailableItemCount(sceneId,selfId,Item2ID)
	local Item3 = 0;
	if Item3ID ~= 0 then
		Item3 = LuaFnGetAvailableItemCount(sceneId,selfId,Item3ID)
	end
	
	if Item1 + Item2 + Item3 < nNum then
		x045050_NotifyTip( sceneId, selfId, "Không có ðü "..nNum.." cái "..GetItemName(sceneId,Item1ID))
		return -1;
	end
	
	if Item1 >= nNum then
		LuaFnDelAvailableItem(sceneId,selfId,Item1ID,nNum)
	elseif Item1 + Item2 >= nNum then
		LuaFnDelAvailableItem(sceneId,selfId,Item1ID,Item1)
		LuaFnDelAvailableItem(sceneId,selfId,Item2ID,nNum-Item1)
	elseif Item1 + Item2 + Item3 >= nNum then
		LuaFnDelAvailableItem(sceneId,selfId,Item1ID,Item1)
		LuaFnDelAvailableItem(sceneId,selfId,Item2ID,Item2)
		LuaFnDelAvailableItem(sceneId,selfId,Item3ID,nNum-Item1-Item2)
	end
	
	return 1;
end